<!DOCTYPE html> 
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ExplanaGg</title>
<link rel="shortcut icon" href="logo.png" type="image/x-icon">
<style>

@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap');

:root{
  --bg: #0b0b0b;
  --card: #111;
  --glass: rgba(255,255,255,0.04);
  --border: #1e1e1e;
  --accent: #ff008c;
  --accent-light: #ff44cc;
  --text-muted: #b8b8b8;
}

*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:"Poppins", sans-serif;
}

body{
  background:var(--bg);
  color:#f5f5f5;
  min-height:100vh;
}


.container{
  margin-top: 60px;
  width:100%;
  max-width:600px;
  background:#0f0f0f;
  border:1px solid var(--border);
  border-radius:18px;
  padding:30px;
  box-shadow:0 0 25px #00000080;
  backdrop-filter:blur(8px);
}

h1{
  font-size:28px;
  font-weight:700;
  margin-bottom:10px;
  background:linear-gradient(550deg, var(--accent), var(--accent-light));
  -webkit-background-clip:text;
  color:transparent;
}

p{
  font-size:15px;
  color:var(--text-muted);
  margin-bottom:18px;
}

/* ========= BOTÕES ========= */
button{
    background-color:#ff008c77 ;
  border:none;
  padding:12px 18px;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
  color:#fff;
  transition:.3s;
  
}

button:hover{
  transform:scale(1.05);
  background:#ff008cdd;
}

button.secondary{
  background:transparent;
  border:1px solid #333;
  color:var(--text-muted);
  box-shadow:none;
}

.secondary:hover{
  border-color:var(--accent);
  color:#fff;
}

/* ===== CARD DO CÓDIGO SALVO ===== */
.card{
  background:#111;
  border:1px solid #1f1f1f;
  padding:18px;
  border-radius:14px;
  margin-top:20px;
  box-shadow:0 0 20px #00000066;
}

/* ======= MODAL ======== */
.modal-backdrop{
  position:fixed;
  inset:0;
  display:none;
  justify-content:center;
  align-items:center;
  z-index:999;
}

.modal{
  width:100%;
  max-width:360px;
  background:#0f0f0f;
  padding:25px;
  border-radius:16px;
  border:1px solid #1e1e1e;
  box-shadow:0 0 25px #00000088;
}

.modal h2{
  font-size:22px;
  margin-bottom:10px;
  font-weight:700;
}

input{
  width:100%;
  padding:12px;
  background:#111;
  border:1px solid #222;
  color:#fff;
  border-radius:10px;
  margin-top:12px;
  margin-bottom:10px;
  font-size:15px;
}

input:focus{
  outline:none;
  border-color:var(--accent);
  
}

/* RESULTADO */
.result{
  background:#111;
  border:1px solid #222;
  padding:12px;
  border-radius:10px;
  margin-top:12px;
  display:none;
  color:#fff;
  box-shadow:0 0 10px #00000055 inset;
}

.logo{
    height: 90px;
}

.search-box {
    width: 420px;
    display: flex;
    background: #111;
    border: 1px solid #222;
    border-radius: 10px;
    overflow: hidden;
    transition: 0.3s;
}

.search-box input {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    padding: 12px 15px;
    color: #fff;
    font-size: 15px;
}

.search-btn {
    background: #ff008c77;
    border: none;
    padding: 0 18px;
    cursor: pointer;
    transition: 0.3s;
}

.search-btn:hover {
    background: #e6007f;
}


    *{ margin:0; padding:0; box-sizing:border-box; font-family:"Poppins",sans-serif; }
    body{ background:#0b0b0b; color:#f5f5f5; overflow-x:hidden; }

    header{
        width:100%; padding:20px 6%; display:flex; justify-content:space-between; align-items:center;
        background:#0f0f0f; position:sticky; top:0; z-index:1000; border-bottom:1px solid #1e1e1e;
        backdrop-filter:blur(8px); box-shadow:0 4px 20px #00000055;
    }

    .logo{
        height: 90px;
    }


@media (max-width: 992px){
    header{
        flex-direction: column;
        gap: 15px;
    }
}

@media (max-width: 768px) {
    .logo {
        width: 130px;
    }
}

@media (max-width: 600px){

    header{
        padding:15px 5%;
    }

</style>
</head>
<body>

<header>
    <a href="index.html"><img src="logo.png" alt="DarkStore Logo" class="logo"></a>
  
</header>

  <center>
      <div class="container">
        <h1>Resgatar Código</h1>
        <p>Insira seu código para liberar suas informações.
        O código ficará salvo para você automaticamente.</p>
        <button id="openBtn">Inserir código</button>
        <div class="card" style="margin-top:20px">
          <div style="font-size:13px;color:var(--muted)">Seu último código salvo:</div>
          <div id="savedCode" style="font-size:16px;font-weight:600;margin-top:6px">Nenhum resgatado</div>
          <div style="margin-top:12px;font-size:13px;color:var(--muted)">Informações liberadas:</div>
          <div id="savedEmail" style="margin-top:4px">—</div>
          <div id="savedPass">—</div>
        </div>
      </div>
  </center>

  <!-- MODAL -->
  <div class="modal-backdrop" id="modal">
    <div class="modal">
      <h2 style="font-size:18px">Inserir código</h2>
      <input id="codeInput" type="text" placeholder="Ex: CODE123"/>

      <div style="display:flex;justify-content:flex-end;gap:10px;margin-top:10px">
        <button class="secondary" id="cancelBtn">Cancelar</button>
        <button id="submitBtn">Confirmar</button>
      </div>

      <div class="result" id="resultBox"></div>
    </div>
  </div>

<script>
// ELEMENTOS
const modal = document.getElementById("modal");
const openBtn = document.getElementById("openBtn");
const cancelBtn = document.getElementById("cancelBtn");
const submitBtn = document.getElementById("submitBtn");
const resultBox = document.getElementById("resultBox");
const codeInput = document.getElementById("codeInput");

const savedCode = document.getElementById("savedCode");
const savedEmail = document.getElementById("savedEmail");
const savedPass = document.getElementById("savedPass");

// CARREGAR DO LOCALSTORAGE
const saved = localStorage.getItem("codigoResgatado");

if (saved) {
  // buscar dados salvos no backend (não expõe nada)
  fetch(`/.netlify/functions/verificarCodigo?code=${saved}`)
    .then(r => r.json())
    .then(data => {
      if (data.ok) {
        savedCode.textContent = saved;
        savedEmail.textContent = "Email: " + data.email;
        savedPass.textContent  = "Senha: " + data.pass;
      }
    })
    .catch(() => {});
}

// MODAL
openBtn.onclick = () => {
  modal.style.display = "flex";
  codeInput.value = "";
  resultBox.style.display = "none";
  setTimeout(() => codeInput.focus(), 80);
};

cancelBtn.onclick = () => { modal.style.display = "none"; };
modal.onclick = (e) => { if (e.target === modal) modal.style.display = "none"; };

// SUBMIT
submitBtn.onclick = handleSubmit;
codeInput.addEventListener("keydown", e => {
  if (e.key === "Enter") handleSubmit();
});

function handleSubmit() {
  const typed = codeInput.value.trim().toUpperCase();

  if (!typed) {
    showResult("Digite um código válido.", false);
    return;
  }

  fetch(`/.netlify/functions/verificarCodigo?code=${typed}`)
    .then(r => r.json())
    .then(data => {
      if (!data.ok) {
        showResult("Código inválido. Tente novamente.", false);
        return;
      }

      // SALVAR LOCAL
      localStorage.setItem("codigoResgatado", typed);

      // EXIBIR
      showResult(
        `Código válido!<br><br>
        Email: <strong>${data.email}</strong><br>
        Senha: <strong>${data.pass}</strong>`,
        true
      );

      // ATUALIZAR PAINEL
      savedCode.textContent = typed;
      savedEmail.textContent = "Email: " + data.email;
      savedPass.textContent  = "Senha: " + data.pass;
    })
    .catch(() => {
      showResult("Erro ao conectar com o servidor.", false);
    });
}

// VISUAL DO RESULTADO
function showResult(msg, ok) {
  resultBox.style.display = "block";
  resultBox.style.color = ok ? "#6ee7b7" : "#f55";
  resultBox.innerHTML = msg;
}
</script>
</body>
</html>
